<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZOO_ALV_EKKO</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZOO_ALV_EKKO</h2>
<h3> Description: ALV Display</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Report&nbsp;&nbsp;ZOO_ALV_EKKO<br />
*&<br />
*&---------------------------------------------------------------------*<br />
*&<br />
*&<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;REPORT&nbsp;zoo_alv_ekko.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLASS&nbsp;cl_vbrk&nbsp;DEFINITION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PUBLIC&nbsp;SECTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;TYPES:<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;ty_vbrk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;vbeln&nbsp;TYPE&nbsp;vbeln_vf,<br />
&nbsp;&nbsp;&nbsp;&nbsp;fkart&nbsp;TYPE&nbsp;fkart,<br />
&nbsp;&nbsp;&nbsp;&nbsp;fktyp&nbsp;TYPE&nbsp;fktyp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;vsbed&nbsp;TYPE&nbsp;vsbed,<br />
&nbsp;&nbsp;&nbsp;&nbsp;belnr&nbsp;TYPE&nbsp;belnr_d,<br />
&nbsp;&nbsp;&nbsp;&nbsp;gjahr&nbsp;TYPE&nbsp;gjahr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ty_vbrk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;ty_vbrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;vbeln&nbsp;TYPE&nbsp;vbeln_vf,<br />
&nbsp;&nbsp;&nbsp;&nbsp;posnr&nbsp;TYPE&nbsp;posnr_vf,<br />
&nbsp;&nbsp;&nbsp;&nbsp;meins&nbsp;TYPE&nbsp;meins,<br />
&nbsp;&nbsp;&nbsp;&nbsp;aubel&nbsp;TYPE&nbsp;aubel,<br />
&nbsp;&nbsp;&nbsp;&nbsp;charg&nbsp;TYPE&nbsp;charg_d,<br />
&nbsp;&nbsp;&nbsp;&nbsp;netwr&nbsp;TYPE&nbsp;netwr_fp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ty_vbrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;BEGIN&nbsp;OF&nbsp;ty_final,<br />
&nbsp;&nbsp;&nbsp;&nbsp;vbeln&nbsp;TYPE&nbsp;vbeln_vf,<br />
&nbsp;&nbsp;&nbsp;&nbsp;fkart&nbsp;TYPE&nbsp;fkart,<br />
&nbsp;&nbsp;&nbsp;&nbsp;fktyp&nbsp;TYPE&nbsp;fktyp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;vsbed&nbsp;TYPE&nbsp;vsbed,<br />
&nbsp;&nbsp;&nbsp;&nbsp;belnr&nbsp;TYPE&nbsp;belnr_d,<br />
&nbsp;&nbsp;&nbsp;&nbsp;gjahr&nbsp;TYPE&nbsp;gjahr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;posnr&nbsp;TYPE&nbsp;posnr_vf,<br />
&nbsp;&nbsp;&nbsp;&nbsp;meins&nbsp;TYPE&nbsp;meins,<br />
&nbsp;&nbsp;&nbsp;&nbsp;aubel&nbsp;TYPE&nbsp;aubel,<br />
&nbsp;&nbsp;&nbsp;&nbsp;charg&nbsp;TYPE&nbsp;charg_d,<br />
&nbsp;&nbsp;&nbsp;&nbsp;netwr&nbsp;TYPE&nbsp;netwr_fp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;ty_final.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_vbrk&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_vbrk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_vbrk&nbsp;&nbsp;TYPE&nbsp;ty_vbrk,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_vbrp&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_vbrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_vbrp&nbsp;&nbsp;TYPE&nbsp;ty_vbrp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt_final&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ty_final,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_final&nbsp;TYPE&nbsp;ty_final,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_tool&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_functions_list,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_columns&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_columns,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_layout&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_layout,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_zebra&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_display_settings,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_logo&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_form_layout_logo,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_grid&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_form_layout_grid,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_total&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_aggregations,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_stotal&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_sorts,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_st_table&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_sort,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_content&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_form_element,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_title&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_row&nbsp;TYPE&nbsp;string,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_label&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_form_label,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lo_flow&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_salv_form_layout_flow.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;METHODS:&nbsp;fetch_data,<br />
&nbsp;&nbsp;&nbsp;&nbsp;display_data.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCLASS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLASS&nbsp;cl_vbrk&nbsp;IMPLEMENTATION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;METHOD&nbsp;fetch_data.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;vbeln&nbsp;fkart&nbsp;fktyp&nbsp;vsbed&nbsp;belnr&nbsp;gjahr<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;vbrk&nbsp;INTO&nbsp;TABLE&nbsp;lt_vbrk.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;vbeln&nbsp;posnr&nbsp;meins&nbsp;aubel&nbsp;charg&nbsp;netwr<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;vbrp&nbsp;INTO&nbsp;TABLE&nbsp;lt_vbrp<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;lt_vbrk<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;vbeln&nbsp;=&nbsp;lt_vbrk-vbeln.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;lt_vbrp&nbsp;INTO&nbsp;ls_vbrp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;ls_final.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-vbeln&nbsp;=&nbsp;ls_vbrp-vbeln.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-posnr&nbsp;=&nbsp;ls_vbrp-posnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-meins&nbsp;=&nbsp;ls_vbrp-meins.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-aubel&nbsp;=&nbsp;ls_vbrp-aubel.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-charg&nbsp;=&nbsp;ls_vbrp-charg.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-netwr&nbsp;=&nbsp;ls_vbrp-netwr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;lt_vbrk&nbsp;INTO&nbsp;ls_vbrk&nbsp;WITH&nbsp;KEY&nbsp;vbeln&nbsp;=&nbsp;ls_vbrp-vbeln&nbsp;BINARY&nbsp;SEARCH.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-fkart&nbsp;=&nbsp;ls_vbrk-fkart.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-fktyp&nbsp;=&nbsp;ls_vbrk-fktyp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-vsbed&nbsp;=&nbsp;ls_vbrk-vsbed.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-belnr&nbsp;=&nbsp;ls_vbrk-belnr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ls_final-gjahr&nbsp;=&nbsp;ls_vbrk-gjahr.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;ls_final&nbsp;TO&nbsp;lt_final.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;ls_final,ls_vbrk,ls_vbrp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDMETHOD.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;METHOD&nbsp;display_data.<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;cl_salv_table=&gt;factory(<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;r_salv_table&nbsp;=&nbsp;DATA(lo_alv)<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_table&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lt_final<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_msg&nbsp;INTO&nbsp;DATA(lv_msg).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_tool&nbsp;=&nbsp;lo_alv-&gt;get_functions(&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_tool-&gt;set_all(&nbsp;abap_true&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_columns&nbsp;=&nbsp;lo_alv-&gt;get_columns(&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_columns-&gt;set_optimize(&nbsp;'X'&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_zebra&nbsp;=&nbsp;lo_alv-&gt;get_display_settings(&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_zebra-&gt;set_striped_pattern(&nbsp;cl_salv_display_settings=&gt;true&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lo_grid.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;lo_logo.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;lv_row,&nbsp;lv_title.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;lt_final&nbsp;LINES&nbsp;lv_row.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CONCATENATE&nbsp;'No&nbsp;of&nbsp;Records:'&nbsp;lv_row&nbsp;INTO&nbsp;lv_title&nbsp;SEPARATED&nbsp;BY&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_logo-&gt;set_right_logo(&nbsp;'ENJOYSAP_LOGO'&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_label&nbsp;=&nbsp;lo_grid-&gt;create_label(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;"&nbsp;Natural&nbsp;Number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;"&nbsp;Natural&nbsp;Number<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;'sales&nbsp;records'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tooltip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'sales&nbsp;records'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_label-&gt;SET_TEXT(&nbsp;'Purchase&nbsp;Order&nbsp;Details&nbsp;Report'&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;lo_grid-&gt;create_label(<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_title<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tooltip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;lv_title<br />
*&nbsp;&nbsp;&nbsp;&nbsp;).<br />
*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;lo_flow&nbsp;=&nbsp;lo_grid-&gt;CREATE_FLOW(<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;COLUMN&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_flow-&gt;CREATE_TEXT(&nbsp;TEXT&nbsp;=&nbsp;'Date&nbsp;:'&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_flow&nbsp;=&nbsp;lo_grid-&gt;CREATE_FLOW(<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;COLUMN&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_flow-&gt;CREATE_TEXT(&nbsp;TEXT&nbsp;=&nbsp;sy-datum&nbsp;).<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;lo_grid-&gt;create_text(<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;"&nbsp;Natural&nbsp;Number<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;column&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;"&nbsp;Natural&nbsp;Number<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-datum<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tooltip&nbsp;=&nbsp;sy-datum<br />
*&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
*&nbsp;&nbsp;&nbsp;&nbsp;lo_logo-&gt;set_left_content(&nbsp;lo_grid&nbsp;).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;lo_content&nbsp;=&nbsp;lo_logo.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;lo_alv-&gt;set_top_of_list(&nbsp;lo_content&nbsp;).<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;lo_alv-&gt;SET_TOP_OF_LIST(&nbsp;lo_grid&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_alv-&gt;SET_TOP_OF_LIST_PRINT(&nbsp;lo_grid&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_total&nbsp;=&nbsp;lo_alv-&gt;get_aggregations(&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_total-&gt;add_aggregation<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columnname&nbsp;&nbsp;=&nbsp;'NETWR'&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Control:&nbsp;Field&nbsp;Name&nbsp;of&nbsp;Internal&nbsp;Table&nbsp;Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregation&nbsp;=&nbsp;if_salv_c_aggregation=&gt;total&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Aggregation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_data_error.&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_not_found.&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_existing.&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_alv-&gt;get_sorts<br />
&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;=&nbsp;lo_stotal.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Sort<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;TRY&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_stotal-&gt;add_sort<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;columnname&nbsp;=&nbsp;'VBELN'&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Control:&nbsp;Field&nbsp;Name&nbsp;of&nbsp;Internal&nbsp;Table&nbsp;Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lo_st_table.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Sort&nbsp;Settings<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;lo_st_table-&gt;set_subtotal<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE&nbsp;=&nbsp;if_salv_c_bool_sap=&gt;true.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Boolean&nbsp;Variable&nbsp;(X=True,&nbsp;Space=False)<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_not_found.&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_existing.&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;cx_salv_data_error.&nbsp;&nbsp;&nbsp;&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lo_alv-&gt;display(&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDMETHOD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCLASS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;START-OF-SELECTION.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA:&nbsp;obj&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;cl_vbrk.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;obj.<br />
&nbsp;&nbsp;&nbsp;&nbsp;obj-&gt;fetch_data(&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;obj-&gt;display_data(&nbsp;).<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2024. Sap Release 740</td>
   </tr>
</table>
</body>
</html>
